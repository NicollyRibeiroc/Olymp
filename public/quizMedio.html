<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quiz Nível Fácil | Olymp</title>
    <link rel="stylesheet" href="css/quizzes.css" />
</head>

<body>

    <div class="quiz-wrapper">
        <div class="quiz-container">
            <div id="quiz">
                <h1>Quiz de Conhecimento</h1>
                <div class="pergunta-container">
                    <h2 id="pergunta">Pergunta aqui</h2>
                    <ul>
                        <li><button class="botao-resposta">Resposta 1</button></li>
                        <li><button class="botao-resposta">Resposta 2</button></li>
                        <li><button class="botao-resposta">Resposta 3</button></li>
                        <li><button class="botao-resposta">Resposta 4</button></li>
                    </ul>
                </div>
                <button id="botao-proximo" class="botao" style="display: none;">Próxima Pergunta</button>
                <div id="resultado" style="display: none;">
                    <h2>Seu resultado: <span id="pontuacao"></span></h2>
                    <button id="botao-recomecar" class="botao" style="margin-top: 10px;">Recomeçar</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        const perguntas = [
            { pergunta: "Quem era o rei dos deuses na mitologia grega?", respostas: ["Apolo", "Poseidon", "Zeus", "Hades"], correta: "Zeus" },
            { pergunta: "Qual deusa nasceu da espuma do mar?", respostas: ["Ártemis", "Afrodite", "Deméter", "Hera"], correta: "Afrodite" },
            { pergunta: "Qual deus era responsável pelo submundo?", respostas: ["Zeus", "Hades", "Hermes", "Ares"], correta: "Hades" },
            { pergunta: "Quem era o mensageiro dos deuses?", respostas: ["Hermes", "Apolo", "Dionísio", "Ares"], correta: "Hermes" },
            { pergunta: "Qual deus era associado ao vinho e festas?", respostas: ["Dionísio", "Ares", "Hefesto", "Poseidon"], correta: "Dionísio" },
            { pergunta: "Quem era a deusa da sabedoria?", respostas: ["Hera", "Deméter", "Afrodite", "Atena"], correta: "Atena" },
            { pergunta: "Quem era o deus dos mares?", respostas: ["Zeus", "Hades", "Poseidon", "Apolo"], correta: "Poseidon" },
            { pergunta: "Quem foi punido a segurar o céu nos ombros?", respostas: ["Prometeu", "Atlas", "Cronos", "Orfeu"], correta: "Atlas" },
            { pergunta: "Quem matou a Medusa?", respostas: ["Teseu", "Hércules", "Perseu", "Aquiles"], correta: "Perseu" },
            { pergunta: "Qual herói era invulnerável, exceto no calcanhar?", respostas: ["Aquiles", "Hércules", "Ulisses", "Teseu"], correta: "Aquiles" }
        ];

        let indicePerguntaAtual = 0;
        let pontuacao = 0;

        const elementoPergunta = document.getElementById("pergunta");
        const botoesResposta = document.querySelectorAll(".botao-resposta");
        const botaoProximo = document.getElementById("botao-proximo");
        const containerResultado = document.getElementById("resultado");
        const elementoPontuacao = document.getElementById("pontuacao");

        function iniciarQuiz() {
            indicePerguntaAtual = 0;
            pontuacao = 0;
            botaoProximo.style.display = "none";
            containerResultado.style.display = "none";
            exibirPergunta();
        }

        function exibirPergunta() {
            resetarEstado();
            const perguntaAtual = perguntas[indicePerguntaAtual];
            elementoPergunta.innerText = perguntaAtual.pergunta;

            botoesResposta.forEach((botao, index) => {
                botao.innerText = perguntaAtual.respostas[index];
                botao.onclick = selecionarResposta;
            });
        }

        function resetarEstado() {
            botaoProximo.style.display = "none";
            botoesResposta.forEach(botao => {
                botao.disabled = false;
                botao.classList.remove("correto", "incorreto");
            });
        }

        function selecionarResposta(e) {
            const botaoSelecionado = e.target;
            const respostaCorreta = botaoSelecionado.innerText === perguntas[indicePerguntaAtual].correta;

            if (respostaCorreta) {
                botaoSelecionado.classList.add("correto");
                pontuacao++;
            } else {
                botaoSelecionado.classList.add("incorreto");
            }

            botoesResposta.forEach(botao => botao.disabled = true);
            botaoProximo.style.display = "block";
        }

        function exibirResultado() {
            containerResultado.style.display = "block";
            elementoPontuacao.innerText = `${pontuacao} de ${perguntas.length}`;

            // Enviar para o backend com o ID do usuário logado
            const dadosDesempenho = {
                idUsuario: usuario.id,
                idQuiz: 2, //Identificador do quiz médio
                total_perguntas: perguntas.length,
                acertos: pontuacao,
                percentual: ((pontuacao / perguntas.length) * 100).toFixed(2)
            };

            fetch("http://localhost:3000/salvarDesempenho", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(dadosDesempenho)
            })
                .then(res => res.json())
                .then(data => console.log("Desempenho salvo com sucesso:", data))
                .catch(erro => console.error("Erro ao salvar desempenho:", erro));
        }

        botaoProximo.addEventListener("click", () => {
            indicePerguntaAtual++;
            if (indicePerguntaAtual < perguntas.length) {
                exibirPergunta();
            } else {
                exibirResultado();
            }
        });

        document.getElementById("botao-recomecar").addEventListener("click", iniciarQuiz);

        iniciarQuiz();

    </script>
</body >
</html >